<!--
  ~    Copyright 2019 Django Cass
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jumping</title>
</head>
<body>

<style media="screen">
    .content {
        position: absolute;
        left: 50%;
        top: 50%;
        -webkit-transform: translate(-50%, -50%);
        transform: translate(-50%, -50%);
    }
    .loader {
        border: 8px solid #f3f3f3; /* Light grey */
        border-top: 8px solid #3F51B5; /* Blue */
        border-radius: 50%;
        width: 96px;
        height: 96px;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>

<div class="content"><div class="loader"></div></div>

<script>
    const BASE_URL="http://localhost:7000";
    const endpoint = `${BASE_URL}/v1/`;

    const storageToken = "jmp-token";
    const storageUser = "jmp-user";

    let url = new URL(window.location.href);
    if(url.searchParams.has("query")) {
        let query = url.searchParams.get("query");
        let redirect = `${endpoint}jump/${query}?token=`;
        if(localStorage.getItem(storageToken) !== null)
            redirect += `${localStorage.getItem(storageToken)}&user=${localStorage.getItem(storageUser)}`;
        else
            redirect += "global";
        window.location.replace(redirect);
    }
</script>

</body>
</html>
